//--Copyright (c) Robert A. Howell  2026
const secrets={cryptography:{new:()=>globalThis.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"]),encryptText:async(e,t)=>{let n=await globalThis.crypto.subtle.encrypt({name:"RSA-OAEP"},e,t);return new Uint8Array(n)},exportKey:async e=>await globalThis.crypto.subtle.exportKey("pkcs8",e)},bus:{encrypt:(e,t,n)=>{if(null==e||!e.length>0)return;const r=t;let s=new TextEncoder;return secrets.cryptography.new().then(t=>(null===r&&(async()=>{new Promise((e,n)=>e(secrets.cryptography.exportKey(t.privateKey))).then(e=>{const t=`-----BEGIN PRIVATE KEY-----\n${new Uint8Array(e).toBase64()}\n-----END PRIVATE KEY-----`;window.sessionStorage.setItem(n,t)})})(),secrets.cryptography.encryptText(t.publicKey,s.encode(e)).then(e=>{let t=e.toBase64();if(null===r)return window.sessionStorage.setItem(`${n}-ciphertext`,t.toString()),e.toString();r.textContent=t})))}}};export default secrets;
//--Copyright (c) Robert A. Howell  2026
const secrets={cryptography:{import:e=>globalThis.crypto.subtle.importKey("pkcs8",e,{name:"RSA-OAEP",hash:"SHA-256"},!0,["decrypt"]),decryptText:async(e,t)=>{const r=Uint8Array.fromBase64(t);let s=await globalThis.crypto.subtle.decrypt({name:"RSA-OAEP"},e,r.buffer);return(new TextDecoder).decode(s)}},bus:{decrypt:(e,t)=>{if(null==e||null==t)return;const r=window.sessionStorage.getItem(e),s=Uint8Array.fromBase64(r.split("\n")[1]);return s?secrets.cryptography.import(s).then(e=>secrets.cryptography.decryptText(e,t).then(e=>e)):void 0}}};export default secrets;